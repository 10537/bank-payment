<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <record model="ir.ui.view" id="transaction_wizard_first">
            <field name="name">transaction.wizard.first</field>
            <field name="type">form</field>
            <field name="model">banking.transaction.wizard</field>
            <field name="arch" type="xml">
                <form string="Match transaction">
                    <!-- fields used for form logic -->
                    <field name="payment_order_ids" invisible="True"/>
                    <field name="invoice_ids" invisible="True"/>
                    <field name="move_line_ids" invisible="True"/>
                    <field name="match_multi" invisible="True"/>
                    <field name="duplicate" invisible="True"/>

                    <group colspan="2" col="2">
                        <group colspan="2" col="2" attrs="{'invisible': [('duplicate', '=', False)]}">
                            <separator string="Duplicate flag"/>
                            <label colspan="2" string="This bank transfer was marked as a duplicate. You can either confirm that this is not the case, or remove the bank transfer from the system."/>
                            <newline/>
                            <button colspan="1"
                                    name="reverse_duplicate"
                                    type="object"
                                    string="Remove duplicate flag"/>
                        </group>
                        <group colspan="2" col="2">
                            <separator string="System Match" colspan="2"/>
                            <field name="match_type"/>
                            <group attrs="{'invisible': [('match_multi', '=', False)]}">
                                <label colspan="2" string="Multiple matches were found for this bank transfer. You must pick one of the matches or select a match manually below." />
                            </group>
                            <field name='payment_line_id'
                                   attrs="{'invisible': [('match_type', 'not in', [('payment', 'storno')])]}"/>
                            <group attrs="{'readonly': [('match_multi', '!=' True)]}">
                                <field name='invoice_id'
                                       attrs="{'invisible': [('match_type', '!=', 'invoice')]}"
                                       domain="[('id', 'in', invoice_ids[0][2])]"/>
                                <field name='move_line_id'
                                       attrs="{'invisible': [('match_type', '!=', 'move')]}"/>
                                <field name='payment_order_id'
                                       attrs="{'invisible': [('match_type', '!=', 'payment_order')]}"/>
                            </group>
                            <button colspan="1"
                                    name="select_match"
                                    type="object"
                                    attrs="{'invisible': [('match_multi', '=', False)]}"
                                    string="Select"/>
                            <newline/>
                            <separator string="Retry system match"/>
                            <label string="You can let the system try to match this bank statement line again after you have made any changes in the database (for instance, add an invoice or a bank account)."  colspan="2"/>
                            <newline/>
                            <button colspan="1"
                                    name="trigger_match"
                                    type="object"
                                    string="Match again"/>
                        </group>
                        <separator string="Manual match" colspan="2"/>
                        <field name="manual_invoice_id"/>
                        <field name="manual_move_line_id"/>
                        <newline/>
                        <button colspan="1"
                                name="match_manual"
                                type="object"
                                string="Match"/>
                        <group colspan="2">
                            <separator/>
                            <button icon="gtk-ok" string="Done" special="cancel"/>
                        </group>
                    </group>
                </form>
            </field>
        </record>
    </data>
</openerp>
